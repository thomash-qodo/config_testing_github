<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simple To-Do List</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      background: #f3f4f6;
      padding: 40px 12px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      padding: 20px 18px 16px;
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .app-title {
      font-size: 1.35rem;
      font-weight: 650;
      color: #111827;
    }

    .counter {
      font-size: 0.8rem;
      color: #6b7280;
    }

    form {
      display: flex;
      gap: 8px;
      margin-bottom: 14px;
    }

    input[type="text"] {
      flex: 1;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 0.9rem;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    input[type="text"]:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.15);
    }

    button {
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.15s ease, transform 0.05s ease;
    }

    button:active {
      transform: translateY(1px);
    }

    .btn-add {
      background: #2563eb;
      color: white;
      white-space: nowrap;
    }

    .btn-add:disabled {
      background: #9ca3af;
      cursor: default;
    }

    .filters {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 0.78rem;
      color: #6b7280;
    }

    .filter-buttons {
      display: flex;
      gap: 4px;
    }

    .filter-btn {
      background: transparent;
      border-radius: 999px;
      padding: 4px 8px;
      border: 1px solid transparent;
      color: #6b7280;
    }

    .filter-btn.active {
      border-color: #2563eb;
      color: #2563eb;
      background: rgba(37, 99, 235, 0.06);
    }

    .btn-clear {
      background: transparent;
      color: #ef4444;
      padding: 4px 8px;
    }

    ul {
      list-style: none;
      max-height: 360px;
      overflow-y: auto;
    }

    li {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 6px 2px;
      border-bottom: 1px solid #f3f4f6;
      font-size: 0.9rem;
    }

    li:last-child {
      border-bottom: none;
    }

    .todo-main {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }

    .todo-text {
      flex: 1;
      word-break: break-word;
    }

    .todo-text.completed {
      text-decoration: line-through;
      color: #9ca3af;
    }

    .todo-actions {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .btn-small {
      padding: 4px 6px;
      font-size: 0.7rem;
      border-radius: 999px;
    }

    .btn-delete {
      background: #f3f4f6;
      color: #ef4444;
    }

    .btn-edit {
      background: #f3f4f6;
      color: #4b5563;
    }

    .empty-state {
      text-align: center;
      font-size: 0.8rem;
      color: #9ca3af;
      padding: 16px 4px 6px;
    }

    @media (max-width: 480px) {
      body {
        padding: 18px 10px;
      }

      .app {
        padding: 16px 12px 12px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="app-title">To-Do</div>
      <div class="counter" id="counter">0 tasks</div>
    </header>

    <form id="todo-form">
      <input
        id="todo-input"
        type="text"
        placeholder="Add a new task and press Enter..."
        autocomplete="off"
      />
      <button type="submit" class="btn-add" id="add-btn" disabled>Add</button>
    </form>

    <div class="filters">
      <div class="filter-buttons">
        <button type="button" class="filter-btn active" data-filter="all">All</button>
        <button type="button" class="filter-btn" data-filter="active">Active</button>
        <button type="button" class="filter-btn" data-filter="completed">Completed</button>
      </div>
      <button type="button" class="btn-clear" id="clear-completed">Clear completed</button>
    </div>

    <ul id="todo-list"></ul>
    <div class="empty-state" id="empty-state">No tasks yet. Add your first one above.</div>
  </div>

  <script>
    (function () {
      const STORAGE_KEY = 'simple_todo_items_v1';

      /** @type {{ id: string; text: string; completed: boolean; }[]} */
      let todos = [];
      let currentFilter = 'all';

      const form = document.getElementById('todo-form');
      const input = document.getElementById('todo-input');
      const addBtn = document.getElementById('add-btn');
      const list = document.getElementById('todo-list');
      const counter = document.getElementById('counter');
      const emptyState = document.getElementById('empty-state');
      const filterButtons = document.querySelectorAll('.filter-btn');
      const clearCompletedBtn = document.getElementById('clear-completed');

      function loadFromStorage() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return;
          const parsed = JSON.parse(raw);
          if (Array.isArray(parsed)) {
            todos = parsed;
          }
        } catch (e) {
          console.error('Failed to load todos from storage', e);
        }
      }

      function saveToStorage() {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));
        } catch (e) {
          console.error('Failed to save todos to storage', e);
        }
      }

      function updateCounter() {
        const total = todos.length;
        const remaining = todos.filter(t => !t.completed).length;
        const label = total === 1 ? 'task' : 'tasks';
        counter.textContent = `${remaining} of ${total} ${label} left`;
      }

      function render() {
        list.innerHTML = '';

        let visible = todos;
        if (currentFilter === 'active') {
          visible = todos.filter(t => !t.completed);
        } else if (currentFilter === 'completed') {
          visible = todos.filter(t => t.completed);
        }

        if (visible.length === 0) {
          emptyState.style.display = 'block';
        } else {
          emptyState.style.display = 'none';
        }

        visible.forEach(todo => {
          const li = document.createElement('li');

          const main = document.createElement('div');
          main.className = 'todo-main';

          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.checked = todo.completed;
          checkbox.addEventListener('change', () => {
            toggleTodo(todo.id);
          });

          const span = document.createElement('span');
          span.className = 'todo-text' + (todo.completed ? ' completed' : '');
          span.textContent = todo.text;

          main.appendChild(checkbox);
          main.appendChild(span);

          const actions = document.createElement('div');
          actions.className = 'todo-actions';

          const editBtn = document.createElement('button');
          editBtn.type = 'button';
          editBtn.textContent = 'Edit';
          editBtn.className = 'btn-small btn-edit';
          editBtn.addEventListener('click', () => startEditTodo(todo.id));

          const deleteBtn = document.createElement('button');
          deleteBtn.type = 'button';
          deleteBtn.textContent = 'Delete';
          deleteBtn.className = 'btn-small btn-delete';
          deleteBtn.addEventListener('click', () => deleteTodo(todo.id));

          actions.appendChild(editBtn);
          actions.appendChild(deleteBtn);

          li.appendChild(main);
          li.appendChild(actions);

          list.appendChild(li);
        });

        updateCounter();
      }

      function addTodo(text) {
        const trimmed = text.trim();
        if (!trimmed) return;
        todos.unshift({
          id: Date.now().toString(36) + Math.random().toString(36).slice(2, 6),
          text: trimmed,
          completed: false,
        });
        saveToStorage();
        render();
      }

      function toggleTodo(id) {
        todos = todos.map(t => (t.id === id ? { ...t, completed: !t.completed } : t));
        saveToStorage();
        render();
      }

      function deleteTodo(id) {
        todos = todos.filter(t => t.id !== id);
        saveToStorage();
        render();
      }

      function startEditTodo(id) {
        const todo = todos.find(t => t.id === id);
        if (!todo) return;
        const nextText = prompt('Edit task:', todo.text);
        if (nextText === null) return;
        const trimmed = nextText.trim();
        if (!trimmed) {
          deleteTodo(id);
          return;
        }
        todos = todos.map(t => (t.id === id ? { ...t, text: trimmed } : t));
        saveToStorage();
        render();
      }

      function clearCompleted() {
        todos = todos.filter(t => !t.completed);
        saveToStorage();
        render();
      }

      function setFilter(filter) {
        currentFilter = filter;
        filterButtons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.filter === filter);
        });
        render();
      }

      form.addEventListener('submit', e => {
        e.preventDefault();
        addTodo(input.value);
        input.value = '';
        addBtn.disabled = true;
      });

      input.addEventListener('input', () => {
        addBtn.disabled = !input.value.trim();
      });

      filterButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const filter = btn.dataset.filter;
          if (filter) {
            setFilter(filter);
          }
        });
      });

      clearCompletedBtn.addEventListener('click', clearCompleted);

      loadFromStorage();
      render();
    })();
  </script>
</body>
</html>
